var i=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var u=Object.prototype.hasOwnProperty;var g=(o,e)=>{for(var t in e)i(o,t,{get:e[t],enumerable:!0})},m=(o,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of C(e))!u.call(o,r)&&r!==t&&i(o,r,{get:()=>e[r],enumerable:!(n=y(e,r))||n.enumerable});return o};var f=o=>m(i({},"__esModule",{value:!0}),o);var S={};g(S,{handler:()=>A});module.exports=f(S);var s=require("@aws-sdk/client-s3"),c=require("@aws-sdk/s3-request-presigner"),O=new s.S3Client({}),h=process.env.BUCKET_NAME||"your-bucket-name",A=async o=>{console.log("event:",JSON.stringify(o));try{let{method:e,path:t}=o.requestContext.http;if(e==="GET"&&t==="/hello")return{statusCode:200,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({message:"hello from TypeScript"})};if(e==="POST"&&t==="/upload")try{let n=JSON.parse(o.body||"{}"),{fileName:r,fileType:a}=n;if(!r||!a)return{statusCode:400,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({error:"fileName and fileType are required"})};let l=`uploads/${new Date().toISOString().replace(/[:.]/g,"-")}-${r}`,p=new s.PutObjectCommand({Bucket:h,Key:l,ContentType:a}),d=await(0,c.getSignedUrl)(O,p,{expiresIn:300});return{statusCode:200,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({uploadUrl:d,key:l})}}catch(n){return console.error("Upload error:",n),{statusCode:500,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({error:"Failed to generate upload URL"})}}return{statusCode:404,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({error:"Not Found"})}}catch(e){return console.error("Error:",e),{statusCode:500,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"},body:JSON.stringify({error:"Internal server error"})}}};0&&(module.exports={handler});
//# sourceMappingURL=index.js.map
